<main>
  <div class="friends__container">
    <h2>–ú–æ–∏ –¥—Ä—É–∑—å—è</h2>
    <div class="search-friends-content__container">
      <section class="search-friends-slider__container">
        <div class="search-results">
          <div *ngFor="let friend of friends$ | async" class="user-card">
            <div class="user-data">
              <img [src]="getImgPath(friend.img)" class="user_img" />
              <h2>{{ friend.nickname }}</h2>
            </div>
            <div class="friend-btn__container">
              <button
                mat-flat-button
                class="open-friend-calendar"
                (click)="onUserCalendar(friend.id)"
              >
                –ö–∞–ª–µ–Ω–¥–∞—Ä—å
              </button>
              <button
                mat-flat-button
                class="open-friend-traning"
                (click)="onUserTraning(friend.id)"
              >
                –¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏
              </button>
              <button
                mat-flat-button
                class="delete-friend"
                (click)="removeFriends(friend.id)"
              >
                –£–¥–∞–ª–∏—Ç—å
              </button>
            </div>
            <div></div>
          </div>
          <div *ngIf="(friends$ | async)?.length === 0" class="no-results">
            <p>–ü–æ–∫–∞ –Ω–µ—Ç –¥—Ä—É–∑–µ–π üòï</p>
          </div>
        </div>
      </section>
    </div>
  </div>
  <div class="search-friends__container">
    <form [formGroup]="searchFriendsForm" (ngSubmit)="onSubmit()">
      <div class="form-group">
        <input
          class="text-input"
          formControlName="nickname"
          required
          [ngClass]="{
            'valid-border':
              searchFriendsForm.get('nickname')?.valid &&
              searchFriendsForm.get('nickname')?.touched,
            'invalid-border':
              searchFriendsForm.get('nickname')?.invalid &&
              searchFriendsForm.get('nickname')?.touched
          }"
          placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∏–∫–Ω–µ–π–º"
        />
      </div>
    </form>
    <div class="search-friends-content__container">
      <section class="search-friends-slider__container">
        <div class="search-results">
          <div *ngFor="let user of searchResults$ | async" class="user-card">
            <div class="user-info">
              <img [src]="getImgPath(user.img)" class="user_img" />
              <h3>{{ user.name }} {{ user.surname }}</h3>
              <h2>@{{ user.nickname }}</h2>
              <p>–í–æ–∑—Ä–∞—Å—Ç: {{ getFullYear(user.age) }}</p>
              <p>–ü–æ–ª: {{ user.gender === "male" ? "–ú—É–∂—Å–∫–æ–π" : "–ñ–µ–Ω—Å–∫–∏–π" }}</p>
            </div>
            <div
              *ngIf="user.friendStatus === 'self'"
              class="no-friend-btn__container"
            >
              <button mat-flat-button class="no-open">–≠—Ç–æ –í—ã</button>
            </div>
            <div
              *ngIf="user.friendStatus === 'friends'"
              class="friend-btn__container"
            >
              <button
                mat-flat-button
                class="open-friend-calendar"
                (click)="onUserCalendar(user.userId)"
              >
                –ö–∞–ª–µ–Ω–¥–∞—Ä—å
              </button>
              <button
                mat-flat-button
                class="open-friend-traning"
                (click)="onUserTraning(user.userId)"
              >
                –¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏
              </button>
              <button
                mat-flat-button
                class="delete-friend"
                (click)="removeFriends(user.userId)"
              >
                –£–¥–∞–ª–∏—Ç—å
              </button>
            </div>
            <div
              *ngIf="user.friendStatus === 'i_sent'"
              class="no-friend-btn__container"
            >
              <button mat-flat-button class="request-pending">
                –ó–∞–ø—Ä–æ—Å –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω
              </button>
            </div>
            <div
              *ngIf="user.friendStatus === 'sent_to_me'"
              class="no-friend-btn__container"
            >
              <button
                (click)="goRequestList()"
                mat-flat-button
                class="incoming-request"
              >
                –í—Ö–æ–¥—è—â–∏–π –∑–∞–ø—Ä–æ—Å
              </button>
            </div>
            <div
              *ngIf="user.friendStatus === 'none'"
              class="no-friend-btn__container"
            >
              <button
                mat-flat-button
                class="start-request"
                (click)="sendFriendsRequest(user.userId)"
              >
                –î–æ–±–∞–≤–∏—Ç—å –≤ –¥—Ä—É–∑—å—è
              </button>
            </div>
          </div>
          <div
            *ngIf="(searchResults$ | async)?.length === 0"
            class="no-results"
          >
            <p>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã üòï</p>
          </div>
        </div>
      </section>
    </div>
  </div>
</main>

<div class="loader" *ngIf="loaderVisible">
  <div class="spinner"></div>
</div>
<notification
  [message]="errorMessage"
  [bgColor]="bgColorNotification"
></notification>
